{% import "template_fcns/htmlAttrs.xml" as htmlAttrs %}

{# each data item expects the format
##  '<--fieldName-->' => [
##      'value' =>
##      ('collapse') =>
##      ('cellWd') =>
##      ('href') =>
#}  ]

{% macro createTable(data, headings) %}
    {% import _self as tables %}
    <table class='table table-responsive table-layout-fixed'>
        <thead>
            <tr>
                <!--<pre>{{ dump(headings) }}</pre>-->
                {{ tables.createHeadings(headings) }}
            </tr>
        </thead>
        <tbody>
            {% for row in data %}
                {{ tables.createRow(row) }}
            {% endfor %}
        </tbody>
    </table>
{% endmacro %}

{% macro createHeadings(headings) %}
    {% import _self as tables %}
    {% for heading in headings %}
        {% if not heading is iterable %}
            <th>{{ heading }}</th>
        {% else %}
            {{ tables.createHeadingFromArray(heading) }}
        {% endif %}
    {% endfor %}
{% endmacro%}

{% macro createHeadingFromArray(array) %}
    {% set cellWd = array.cellWd is empty ? '' : array.cellWd %}
    {% set collapse = array.collapse is empty ? '' : array.collapse %}
    <th
        scope='col'
        classList='{{ collapse }}'
        styleList='{{ cellWd }}'
        {#{{ htmlAttrs.concatClasses(collapse) }}#}
        {#{{ htmlAttrs.concatStyles(cellWd) }}#}
    >{{ array.value }}</th>
{% endmacro %}

{% macro createRow(row) %}
    <tr>
        {% for field in row %}
            <!--{% if not field is iterable %}-->
            <!--    <td>{{ field }}</td>-->
            <!--{% else %}-->
                <td>{{ field.value }}</td>
            <!--{% endif %}-->
        {% endfor %}
    </tr>
{% endmacro %}